2020-11-11 17:41:01.972034: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-11-11 17:41:02.068304: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-11-11 17:41:02.068626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.4805
pciBusID: 0000:01:00.0
totalMemory: 3.94GiB freeMemory: 3.01GiB
2020-11-11 17:41:02.068714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-11-11 17:41:02.268567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-11-11 17:41:02.268695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-11-11 17:41:02.268733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-11-11 17:41:02.268864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2722 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/sparse_ops.py:1165: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
wandb: W&B is a tool that helps track and visualize machine learning experiments
wandb: No credentials found.  Run "wandb login" to visualize your metrics
wandb: Started W&B process version 0.8.12 with PID 928
wandb: Wandb version 0.10.10 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Local directory: wandb/run-20201111_174110-1n0o2ae2
Loading dictionaries from: /home/dev/src/code2seq/models/java-large-model/model_iter52.release
Done loading dictionaries
Evaluation reader cannot find file: 
Done loading model
code2seq<class 'code2seq.interactive_predict.InteractivePredictor'>
<class 'code2seq.interactive_predict.InteractivePredictor'>

2020-11-11 17:41:11.234229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-11-11 17:41:11.234266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-11-11 17:41:11.234277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-11-11 17:41:11.234292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-11-11 17:41:11.234374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2722 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
WARNING:tensorflow:From /home/dev/src/models/model.py:330: calling norm (from tensorflow.python.ops.linalg_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
Tokenizing and building vocabulary for code snippets and queries.  This step may take several hours.
Starting training run neuralbowmodel-2020-11-11-17-41-10 of model NeuralBoWModel with following hypers:
{'code_token_vocab_size': 10000, 'code_token_vocab_count_threshold': 10, 'code_token_embedding_size': 128, 'code_use_subtokens': False, 'code_mark_subtoken_end': False, 'code_max_num_tokens': 200, 'code_use_bpe': True, 'code_pct_bpe': 0.5, 'code_nbow_pool_mode': 'weighted_mean', 'query_token_vocab_size': 10000, 'query_token_vocab_count_threshold': 10, 'query_token_embedding_size': 128, 'query_use_subtokens': False, 'query_mark_subtoken_end': False, 'query_max_num_tokens': 30, 'query_use_bpe': True, 'query_pct_bpe': 0.5, 'query_nbow_pool_mode': 'weighted_mean', 'batch_size': 1000, 'optimizer': 'Adam', 'seed': 0, 'dropout_keep_rate': 0.9, 'learning_rate': 0.01, 'learning_rate_code_scale_factor': 1.0, 'learning_rate_query_scale_factor': 1.0, 'learning_rate_decay': 0.98, 'momentum': 0.85, 'gradient_clip': 1, 'loss': 'cosine', 'margin': 1, 'max_epochs': 300, 'patience': 5, 'fraction_using_func_name': 0.1, 'min_len_func_name_for_query': 12, 'query_random_token_frequency': 0.0}
Loading training and validation data.
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Exception
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Exception
Serving
Exception
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving
Serving